# VMP学习随手简记




VMP入口处

早期：

```
push xxx
jmp xxx
```

现在：

```
push xxx
call xxx
```



VMP局部虚拟机，更重函数保护以及函数调用之间的保护，统称函数隐匿性保护

函数隐匿性：

- 无缝跳转                         抽象化
- 虚拟机参数转移              抽象化
- 虚拟机漂移                     抽象化
- 虚拟机合流                     抽象化

对付流程结构，函数调用流程结构：

- 数据追踪，数据真实化                           数据还原是抽象的，是具有不稳性状态
- 所处的栈是真实的                                  数据追踪可以有效的利用数据流追踪
- 精确寄存器是真实的 `esp, ebp`             数据追踪可以有效的利用数据流追踪
- 函数的返回地址是真实的                       数据追踪可以有效的利用数据流追踪

数据追踪：

- 上下文追踪，追踪特征，`pushfd test`之间的调用关系 --&gt; 指定一个逻辑流程结构
- 精确寄存器      --&gt;      函数的调用变化
- 栈结构是真实的      --&gt;      是可以定位出参数，用参数推导出这个函数的大致作用
- ESP      --&gt;      定位虚拟机的退出和进入





---

> 作者: lo1see  
> URL: http://localhost:1313/posts/vmp%E5%AD%A6%E4%B9%A0%E9%9A%8F%E6%89%8B%E7%AE%80%E8%AE%B0/  

